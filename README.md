# anomalydetection
using reforcement learning to enhance svm model by optimaizing hyperparameters to detect anomanous traffic

movition：
~~ 基于机器学习的入侵检测系统有很多需要提升的地方，如特征提取、模型优化，我们使用强化学习对现有异常检测系统进行优化，实现动态自适应 ~~
传统的机器学习模型需要手动调参以达到最优效果，这种方式需要一定的人力成本，而且对于不同的数据集手动调参的模型可能会呈现不同的性能，需要一种自动调参的方法。以往的自动调参可以使用优化方法来实现，如粒子群、遗传算法等，强化学习的出现使机器能够对环境做出最优决策，我们利用强化学习对模型超参数进行优化，并与传统优化算法进行对比，在不同数据集上观察实验结果。
为什么选用svm：
目前基于机器学习的入侵检测分为两种，传统机器学习和深度学习，传统机器学习中svm的精度最高，深度学习不需要特征处理就可以表现出不错的性能，但训练成本较高，有一些研究提出将深度学习与传统ml模型结合，前者用来做特征提取，后者用于分类，本文中我们使用随机森林进行特征提取，得到十个最优特征，再输入svm模型进行分类。我们的工作主要在分类上进行了优化，对超参数（C和gamma）自动调整

Use q-learning to select features on dataplane,then send these features to controller by Packet-In,but RL is a strategy optimization method,it can help regulate the parameters of algorithm,but it doesn't suit for feature selection.Furthermore,the RL model is trained at a intelligent enviornment,and install in the dataplane,it cannot learn new flow on dataplane,so it cannot adapt to new detection.

The new plan is use qlearning to optimize gamma parameter of nuclear mothod in svm model.SVM is the efficient machine learning algorithm in instrusion detection,gamma parameter is a key hyperparameter of it,its value decides the precision of model.

This repository contains simple svm model implementation,feature extraction using RF(random forest),and QSVM(enhanced svm by q-learning) implementation

Roadmile

- feature extraction ** done **
- svm model implementation ** done **
- QSVM design ** done **
- QSVM implementation ** doing **

实验对比：
本实验主要是利用强化学习算法进行 SVM 模型参数优化，具有相同作用的还有一些常见的优化算法，如粒子群优化算法、遗传算法
评估标准：
从准确率（Accuracy）、精确率（Precision）、召回率（Recall）、F1 分数（F1-score）四个指标来对模型进行评估
Accuracy = (TP + TN) / (TP + FP + FN + TN)
Precision = TP / (TP + FP)
Recall = TP / (TP + FN)
F1 = 2 _ (Precision _ Recall) / (Precision + Recall)
将本设计与粒子群优化算法、遗传算法优化后的 svm 进行对比实验，说明优化效果

数据集
在CICIDS2019、CICIDS2017和NSL-KDD三个数据集上进行实验，对比在不同数据集上的收敛效果

该算法是用于SDN中的入侵检测，所以如何将其应用在模拟环境中是需要思考的问题
基本框架是数据包流经交换机，控制器定期收集交换机中的流量信息，在应用层进行分类，再根据分类结果将流规则下发至数据平面

异常捕获流的数量也可以用于评估模型性能，如果优化后的入侵检测的捕获率高于之前的，就说明我们的算法是有价值的



reference
The following text was generated by chatgpt
在支持向量机（SVM）中，`gamma`是一个重要的参数，它控制了核函数的影响范围。在 SVM 中，核函数用于将特征映射到高维空间，从而使数据在新的高维空间中可以更容易地被线性分割。
`gamma`参数主要影响了 SVM 模型的复杂度和拟合效果：

- 当`gamma`较小的时候，核函数的影响范围较广，模型更简单，可能会出现欠拟合的情况。
- 当`gamma`较大的时候，核函数的影响范围较小，模型更复杂，可能会出现过拟合的情况。
  通常情况下，`gamma`的选择与数据的分布以及特征的数量有关。对于不同的问题，可能需要通过交叉验证等方法来选择合适的`gamma`值，以获得更好的模型性能。
  在 Scikit-learn 的 SVM 中，`gamma`参数是 SVC 类的一个参数，你可以通过设置`gamma`来控制核函数的影响范围。具体来说，对于线性核函数，`gamma`并不会被使用，因为线性核函数不涉及到任何特征映射，所以设置什么值都不会有影响。对于其他核函数（如 RBF 核函数），`gamma`则会影响模型的效果。
